// ============================================================================
// File: rpc_request.fbs
// Namespace: fbs.cuda.ipc.api
// ---------------------------------------------------------------------------
// RPC Request tables for CUDA IPC, using common definitions.
// ============================================================================

include "common.fbs";

namespace fbs.cuda.ipc.api;

// ---------------------------------------------------------------------------
// CUDA Buffer Creation Request
// ---------------------------------------------------------------------------
table CreateCUDABufferRequest {
  size: uint64;
  expiration: ExpirationOption;
}

// ---------------------------------------------------------------------------
// CUDA Buffer Retrieval Request
// ---------------------------------------------------------------------------
table GetCUDABufferRequest {
  buffer_id: UUID (required);
}

// ---------------------------------------------------------------------------
// Notify Buffer Usage Completion Request
// ---------------------------------------------------------------------------
table NotifyDoneRequest {
  buffer_id: UUID (required);
  access_id: uint32;
}

// ---------------------------------------------------------------------------
// CUDA Buffer Free Request
// ---------------------------------------------------------------------------
table FreeCUDABufferRequest {
  buffer_id: UUID (required);
}

// ---------------------------------------------------------------------------
// Union of all possible RPC request types
// ---------------------------------------------------------------------------
union RPCRequest {
  CreateCUDABufferRequest,
  GetCUDABufferRequest,
  NotifyDoneRequest,
  FreeCUDABufferRequest
}

// ---------------------------------------------------------------------------
// Root type for RPC request messages
// ---------------------------------------------------------------------------
table RPCRequestMessage {
  request: RPCRequest (required);
}
root_type RPCRequestMessage;
